<!DOCTYPE html>



<html lang="es">

<head>

    <meta charset="utf-8" />

    <meta content='width=device-width, initial-scale=1.0, maximum-scale=1.0, user-scalable=0' name='viewport' />

    <meta name="viewport" content="width=device-width" />

    <link href="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.7/css/bootstrap.min.css" rel="stylesheet" />

    <link href="https://maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css" rel="stylesheet">

    <script src="https://ajax.googleapis.com/ajax/libs/jquery/3.6.4/jquery.min.js"></script>

    <title>MeteoJose</title>


    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>


</head>


<body>

    <div>

        <h1 style="text-align: center;"> MeteoJose </h1>

        <p style="text-align: center;"> Estación Meteorológica de José </p>


        <h3> Temperatura </h3>
        <div>
            <canvas id="Temperatura" style="width: 100%; height: 100%;"></canvas>
        </div>


        <h3> Humedad </h3>
        <div>
            <canvas id="Humedad" style="width: 100%; height: 100%;"></canvas>
        </div>


        <h3> Luminosidad </h3>
        <div>
            <canvas id="Luminosidad" style="width: 100%; height: 100%;"></canvas>
        </div>


        <h3> Presión </h3>
        <div>
            <canvas id="Presion" style="width: 100%; height: 100%;"></canvas>
        </div>



        <script>

            const ctxTemperatura = document.getElementById('Temperatura');

            const ctxHumedad = document.getElementById('Humedad');

            const ctxLuminosidad = document.getElementById('Luminosidad');

            const ctxPresion = document.getElementById('Presion');

            window.onload = function () {

                var Datos = [];

                var DatosEpoch = [];
                var DatosTemperatura = [];
                var DatosHumedad = [];
                var DatosLuminosidad = [];
                var DatosPresion = [];

                const url1 = 'https://meteojose.cu.ma/datos.txt'



                $.get(url1, function (data, status) {
                    //alert("Data: " + data + "\nStatus: " + status);
                    Datos = data.split('\n');

                    Datos.forEach(dato => {
                        DatosEpoch.push(new Date(parseInt(dato.split('_')[0])));
                        DatosTemperatura.push(parseFloat(dato.split('_')[1]));
                        DatosHumedad.push(parseFloat(dato.split('_')[2]));
                        DatosLuminosidad.push(parseFloat(dato.split('_')[3]));
                        DatosPresion.push(parseFloat(dato.split('_')[4]));
                    });



                    const DATA_COUNT = DatosEpoch.length;



                    const labels = DatosEpoch;
                    for (let i = 0; i < DATA_COUNT; ++i) {
                        labels.push(i.toString());
                    }

                    // ------

                    const datapointsTemperaturaChart = DatosTemperatura;
                    const DatosTemperaturaChart = {
                        labels: labels,
                        datasets: [
                            {
                                label: 'Cubic interpolation (monotone)',
                                data: datapointsTemperaturaChart,
                                borderColor: 'rgb(255, 99, 132)',
                                fill: false,
                                cubicInterpolationMode: 'monotone',
                                tension: 0.4
                            }
                        ]
                    };


                    const datapointsHumedadChart = DatosHumedad;
                    const DatosHumedadChart = {
                        labels: labels,
                        datasets: [
                            {
                                label: 'Cubic interpolation (monotone)',
                                data: datapointsHumedadChart,
                                borderColor: 'rgb(255, 159, 64)',
                                fill: false,
                                cubicInterpolationMode: 'monotone',
                                tension: 0.4
                            }
                        ]
                    };

                    const datapointsLuminosidadChart = DatosLuminosidad;
                    const DatosLuminosidadChart = {
                        labels: labels,
                        datasets: [
                            {
                                label: 'Cubic interpolation (monotone)',
                                data: datapointsLuminosidadChart,
                                borderColor: 'rgb(75, 192, 192)',
                                fill: false,
                                cubicInterpolationMode: 'monotone',
                                tension: 0.4
                            }
                        ]
                    };

                    const datapointsPresionChart = DatosPresion;
                    const DatosPresionChart = {
                        labels: labels,
                        datasets: [
                            {
                                label: 'Cubic interpolation (monotone)',
                                data: datapointsPresionChart,
                                borderColor: 'rgb(54, 162, 235)',
                                fill: false,
                                cubicInterpolationMode: 'monotone',
                                tension: 0.4
                            }
                        ]
                    };


                    new Chart(ctxTemperatura, {
                        type: 'line',
                        data: DatosTemperaturaChart
                    });


                    new Chart(ctxHumedad, {
                        type: 'line',
                        data: DatosHumedadChart
                    });

                    new Chart(ctxPresion, {
                        type: 'line',
                        data: DatosPresionChart
                    });

                    new Chart(ctxLuminosidad, {
                        type: 'line',
                        data: DatosLuminosidadChart
                    });


                });



            }


        </script>


</body>

</html>