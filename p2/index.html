<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Parallax con Depth Map Mejorado</title>
    <style>
        #container {
            perspective: 1000px;
            overflow: hidden;
            width: 100vw;
            height: 100vh;
            position: relative;
        }
        #parallaxCanvas {
            width: 100%;
            height: 100%;
        }
    </style>
</head>
<body>
    <div id="container">
        <canvas id="parallaxCanvas"></canvas>
    </div>

    <script>
        const depthFactor = 100; // Incrementa este valor para un efecto más fuerte

        // Cargar ambas imágenes
        const loadImage = (src) => new Promise((resolve) => {
            const img = new Image();
            img.src = src;
            img.onload = () => resolve(img);
        });

        async function initParallax() {
            const canvas = document.getElementById('parallaxCanvas');
            const ctx = canvas.getContext('2d');
            canvas.width = window.innerWidth;
            canvas.height = window.innerHeight;

            // Cargar la imagen principal y el depth map
            const image = await loadImage('a1.jpg');
            const depthMap = await loadImage('a1-d.png');

            // Dibujar la imagen en el canvas
            ctx.drawImage(image, 0, 0, canvas.width, canvas.height);

            // Escucha el movimiento del dispositivo
            window.addEventListener('deviceorientation', (event) => {
                const { beta, gamma } = event;

                if (beta === null || gamma === null) return;

                // Aumenta el desplazamiento aplicando una escala adicional
                const offsetX = (gamma / 90) * depthFactor;
                const offsetY = (beta / 90) * depthFactor;

                // Aplicar el efecto de parallax al canvas completo
                canvas.style.transform = `translate3d(${offsetX}px, ${offsetY}px, 0) scale(1.05)`;
            });
        }

        initParallax();
    </script>
</body>
</html>
